### 一、结构

​	Redis服务端是一对多程序，其中每个连接的客户端均对应一个redisClient结构，本质上就是一个结构体，其中存储了客户端相关的信息和输入输出缓冲区之类的数据。多个redisClient结构组成一个链表，由redisServer结构来持有这个链表。

### 二、各个成员

*   套接字描述符：记录客户端与服务端进行TCP连接对应的socket fd。根据客户端类型不同，fd的值不同。如果是普通客户端fd不为-1，如果是伪客户端，fd就等于-1。Redis会在两个地方使用伪客户端，一个用于载入AOF文件恢复数据库状态，一个用于执行LUA脚本中的Redis命令。
*   名字：redisClient结构默认是没有名字的，其name成员默认指向NULL。客户端可以用CLIENT setname命令设置名字，设置了名字的客户端能更加清晰其作用。
*   标志：客户端的表指属性记录了客户端的角色以及客户端目前的状态。标志可以是单个值也可以是多个标志的二进制或。
*   输入缓冲区：存放客户端的命令。由SDS对象实现，可以根据命令长度进行动态加长或缩短。不过其大小不能超过1GB，否则服务端断开这个客户端的连接。
*   命令与命令参数：输入缓冲区保存了格式化后的客户端的命令请求，接着服务端会分析请求并提取出各个参数，保存在客户端结构的argv成员中，且argc成员记录了参数的个数。其中argv[0]是要执行的命令。
*   命令的实现函数：Redis服务端保存了一个字典，这个字典的key是各个命令的字符串，例如“set”，value是一个个的redisCommand结构，redisCommand结构中就包括了对应命令的处理函数的函数指针。而redisClient的一个成员就是指向redisCommand结构的指针，通过argv[0]从字典中获取指向对应命令的redisCommand指针。
*   输出缓冲区：命令执行结果会放在客户端的输出缓冲区中。每个客户端有两个输出缓冲区，一个大小固定，另一个可变。固定大小的缓冲区，其大小伪16KB，而可变长度缓冲区是由一个链表构成，链表中的成员是一个个字符串对象