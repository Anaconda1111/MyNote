### 一、事务的概念

​	Redis中事务是一个单独的隔离操作，事务中的命令都会按照顺序执行，在事务执行的过程当中，不会被其它客户端发送的请求命令打断。事务的主要作用就是串联多个操作防止其它命令插队。

### 二、事务相关语法

1. Multi：Mulit命令用于开启事务，之后输入的命令都会被移入命令队列中，但不会执行，直到输入exec后，Redis才会按照队列中的顺序依次执行命令

 	2. exec：开始执行事务的命令，类似mysql的commit。
 	3. discard：在命令组队阶段使用，可以取消事物。
   	4. watch <key1>  [key] : 在事物开始前(mulit之前)可以用watch监视一个或多个key，如果事物执行前key被改动，那么事物将被打断
   	5. unwatch ：取消对所有key的监视(如果事物已经执行或已经取消，则不用手动unwatch)

Tips：关于事物出错的情况，主要分为两种。第一种是在组队阶段输入的命令有误(即Multi阶段)，此时如果输入exec来执行事物，命令队列中将没有任何一个命令能够成功执行。但如果在组队阶段，命令没有错误，只是在执行阶段出错(例如 incr某个字符串)，此时只有出错的命令执行失败，其它命令照常执行。

### 三、乐观锁和悲观锁

1.  悲观锁：每次取数据的时候都默认会被其它人修改，因此每次取数据都要对数据上锁，这样别人想取数据就会阻塞，直到使用者释放锁。简单来说就是操作前先上锁。
2.  乐观锁：每次取数据时都默认别人不会修改，因此不会上锁，但在更新的时候会判断一下此期间有没有其他人更新过数据。乐观锁适用于多读的应用类型，可以提高吞吐量。Redis用check and set机制实现事物的。

### 四、Redis事物的三特性

1.  单独的隔离操作：事务中的命令会被序列化执行，事物执行过程中不会被其它命令打断。
2.  没有隔离级别的概念：队列中的事物没有提交前都不会被执行。
3.  不保证原子性：队列中某个命令执行失败，其它命令照常执行，没有回滚机制