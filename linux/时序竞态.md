## 一、时序竞态的产生

​	假设这个场景：A定了个闹钟，打算十分钟后醒，但睡了五分钟后被叫去做事，二十分钟后再返回睡觉，但此时闹钟早已经响过，不会再响，因此A睡过头，这便发生了时序竞态。时序竞态在程序中也有可能发生，例如结合alarm函数和pause函数实现的自定义sleep函数，当alarm函数设置了时间后，没有随即进入pause函数（可能是CPU被抢占，也可能是其它情况），导致alarm时间到了，信号发送，但此时还没有回到当前进程，最后回到进程的时候，对信号进行捕捉处理，然后再进入pause函数，但此时已经没有东西可以发信号给pause函数来唤醒进程了。

## 二、时序竞态的解决方法

![1645022818007](D:\DaSan\note\noteImage\1645022818007.png)

简单来说就是先设置对ALRM信号的屏蔽，然后将接触屏蔽函数与pause函数捆绑在一起，这个捆绑的动作要借助一个叫sigsuspend的函数来完成，这个函数传入一个信号集，在执行该函数时将根据传入的信号集对信号进行屏蔽。