## 一、概念

​	优先队列与普通队列的区别就是，队列中的元素被赋予了优先级。普通队列是先进先出的结构，而优先队列则是将优先级最高的队列弹出(优先级视规则而定，通常是最大或最小。)。优先队列实际上的结构是紧密排列的堆，或者称为完全二叉树。
​	优先队列的位置0是不放置元素的，这样做的好处是，每一个节点(除位置1)的父节点都是该节点的下标除以2。

## 二、插入操作

​		以最小堆为例子：

​		优先队列的插入操作可以看作将一个空穴上滤的过程。首先将队列的大小加1，相当于在树的最尾端新增一个空穴。然后循环地判断**空穴的父节点**是否大于插入元素，如果是就代表空穴不能用于放置新增元素(最小堆意味着父节点的元素要比子节点都小)，因此就必须进行**空穴上滤**，将父节点放到空穴原本的位置，将空穴上滤到父节点的位置，然后再进行新一轮循环。需要注意的是，当循环进行到空穴的位置为1时跳出循环，因为位置1没有父节点。

```c++
template <typename T>
void PriorityQueue<T>::push(T value) {
    if (size<capacity){
        size++;
        int i;
        for (i=size;i!=1&&value<valueArray[i/2]; i/=2) {  //最关键部分，对空穴的父节点与
            valueArray[i]=valueArray[i/2];				  //待插入元素进行比较
        }
        valueArray[i]=value;
    }
    else{
        resize();    //堆的大小不足以存放时申请一块更大的内存并进行深度复制
        push(value);
    }
}
```

## 三、删除操作

​	以最小堆为例子：

​	删除操作与插入操作相反，是一个空穴下滤的过程。删除即将堆顶元素提取出来并返回，如此堆顶便产生了一个空穴。要保持最小堆的性质，就必须在堆中剩下的元素里找到一个最小值来填补堆顶的位置，同时不能破坏完全二叉树紧密排列的性质（这一点将在删除操作的最后一步得到保证）。首先是将树中最末尾的元素与堆顶的元素保存，然后将堆的大小减一。此时堆顶产生空穴，然后循环地将**空穴的子节点中较小的一个**与末尾元素进行比较，如果小于末尾元素，执行空穴下滤操作，即将子节点的元素放到父节点，这样就相当于空穴来到了子节点的位置，而如果末尾元素不小于，则跳出循环，执行最后一步：将末尾元素放置在循环截止时的空穴处。当空穴来到没有子节点的节点时，循环也将退出，最后一步保证了空穴一定能移动到末尾位置，保证了完全二叉树的紧密。

```c++
template <typename T>
T PriorityQueue<T>::pop() {
    try{
        if (empty())
            throw ("Is Empty!\n");
        T res=valueArray[1];
        int i,child;
        T lastValue=valueArray[size--];
        for (i=1;i*2<size;i=child) {
            child=i*2;
            if (child+1<size&&valueArray[child]>valueArray[child+1])  //比较两个子节点
                child++;
            if (valueArray[child]<lastValue)              //子节点较小者与末尾元素比较
                valueArray[i]=valueArray[child];		  //小于则空穴下滤
            else
                break;									//大于则退出循环
        }
        valueArray[i]=lastValue;                       
        return res;
    }
    catch (const char *s){
        cout<<s;
    }
}
```

